<?xml version="1.0" encoding="UTF-8"?>
<key-chains
    xmlns="urn:ietf:params:xml:ns:yang:ietf-key-chain">
  <key-chain>
    <name>bgp-key-chain</name>
    <description>"An example of TCP-AO configuration for BGP"</description>
    <key>
      <key-id>55</key-id>
      <lifetime>
        <send-lifetime>
          <start-date-time>2017-01-01T00:00:00Z</start-date-time>
          <end-date-time>2017-02-01T00:00:00Z</end-date-time>
        </send-lifetime>
        <accept-lifetime>
          <start-date-time>2016-12-31T23:59:55Z</start-date-time>
          <end-date-time>2017-02-01T00:00:05Z</end-date-time>
        </accept-lifetime>
      </lifetime>
      <crypto-algorithm>hmac-sha-1</crypto-algorithm>
      <key-string>
	<keystring>testvector</keystring>
      </key-string>
      <authentication
	  xmlns="urn:ietf:params:xml:ns:yang:ietf-tcp">
	<keychain>bgp-key-chain</keychain>
	<enable-ao>true</enable-ao>
	<send-id>65</send-id>
	<recv-id>87</recv-id>
      </authentication>
    </key>
    <key>
      <key-id>56</key-id>
      <lifetime>
        <send-lifetime>
          <start-date-time>2017-01-01T00:00:00Z</start-date-time>
          <end-date-time>2017-02-01T00:00:00Z</end-date-time>
        </send-lifetime>
        <accept-lifetime>
          <start-date-time>2016-12-31T23:59:55Z</start-date-time>
          <end-date-time>2017-02-01T00:00:05Z</end-date-time>
        </accept-lifetime>
      </lifetime>
      <crypto-algorithm>hmac-sha-1</crypto-algorithm>
      <key-string>
	<keystring>testvector</keystring>
      </key-string>
      <authentication
	  xmlns="urn:ietf:params:xml:ns:yang:ietf-tcp">
	<keychain>bgp-key-chain</keychain>
	<enable-ao>true</enable-ao>
	<send-id>65</send-id>
	<recv-id>87</recv-id>
      </authentication>
    </key>
  </key-chain>
</key-chains>

<routing
    xmlns="urn:ietf:params:xml:ns:yang:ietf-routing">
  <control-plane-protocols>
    <control-plane-protocol>
      <type
          xmlns:bgp="urn:ietf:params:xml:ns:yang:ietf-bgp">bgp:bgp</type>
      <name>name:BGP</name>
      <bgp
          xmlns="urn:ietf:params:xml:ns:yang:ietf-bgp">
        <global>
          <as>64496</as>
          <afi-safis>
            <afi-safi>
              <name
                  xmlns:bt=
                  "urn:ietf:params:xml:ns:yang:ietf-bgp-types">bt:ipv6-unicast</name>
            </afi-safi>
          </afi-safis>
        </global>
        <neighbors>
          <neighbor>
            <remote-address>2001:db8::</remote-address>
            <enabled>true</enabled>
            <secure-session-enable>true</secure-session-enable>
            <secure-session>
              <enable-ao>true</enable-ao>
              <ao-keychain>bgp-key-chain</ao-keychain>
            </secure-session>
            <peer-as>64497</peer-as>
            <description>"Peer Router B"</description>
            <timers>
              <hold-time>120</hold-time>
              <keepalive>70</keepalive>
            </timers>
            <afi-safis>
              <afi-safi>
                <name
                    xmlns:bt=
                    "urn:ietf:params:xml:ns:yang:ietf-bgp-types">bt:ipv6-unicast</name>
              </afi-safi>
            </afi-safis>
          </neighbor>
        </neighbors>
      </bgp>
    </control-plane-protocol>
  </control-plane-protocols>
</routing>
